<%= render 'title', :locals => { :title => @title }%>

<% if @emails.length < 1 %>
<h2><center>Aucun messages</center></h2>
<% else %>
<div class="container-fluid">
  <table class="table table-bordered table-striped table-hover">
    <thead>
    <tr>
	<th class="text-center">#</th>	  
	<th class="text-center">Contact</th>
	<th class="text-center">Compte</th>
	<th class="text-center">Objet</th>
	<th class="text-center">Aperçu du contenu</th>
	<th class="text-center">Pièce jointe</th>
	<th class="text-center">Date</th>
	<th class="text-center">Action</th>
    </tr>
    </thead>
<tbody>

  <% @emails.each do |email| %>

    <tr>
		<% if !email.id.nil? and !email.id.blank? %>
			<% then %>
				<td><center><%= email.id %></center></td>
			<% else %>
				<td><center>-</center></td>
		<% end %>

		<% if !email.to.nil?  and !email.to.blank? %>
			<% then %>
				<% if !email.contact_id.nil? %>
					<% then %>
				<td><center><%= link_to email.to , edit_contact_path(email.contact_id), {:title => "Modifier le contact"} %></center></td>
					<% else %>
						<td><center><%= link_to email.to , new_contact_path, {:title => "Créer le contact"} %><center></td>
				<% end %>
			<% else %>
				<td><center>-</center></td>
		<% end %>

		<% if !email.account_id.nil?  and !email.account_id.blank? %>
			<% then %>
				<td><center><%= email.account_id %></center></td>
			<% else %>
				<td><center><span style="background-color: red;" class="badge">Inconnu</span></center></td>
		<% end %>
      
		<% if !email.object.nil?  and !email.object.blank? %>
			<% then %>
				<td><center><%= email.object %></center></td>
			<% else %>
				<td><center>-</center></td>
		<% end %>

		<% if !email.content.nil? then ellipse = email.content.length > 60 ? '...' : '' end %>
		<% if !email.content.nil?  and !email.content.blank? %>
			<% then %>
				<td><center><%= email.content[0..60] + ellipse %></center></td>
			<% else %>
				<td><center>-</center></td>
		<% end %>

		<% if !email.attach_file_name.nil?  and !email.attach_file_name.blank? %>
			<% then %>
				<td><center><%= email.attach_file_name %></center></td>
			<% else %>
				<td><center><span style="background-color: grey;" class="badge">Non</span></center></td>
		<% end %>

		<% if !email.send_at.nil?  and !email.send_at.blank? %>
			<% then %>
				<td><center><%= email.send_at.strftime("%d/%m/%Y à %H:%M") %></center></td>
			<% else %>
				<td><center>-</center></td>
		<% end %>


		<td><center>

			<div class="btn-group">
				<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
				 <%= image_tag('/assets/glyphicons/glyphicons_190_circle_plus.png', :size => '16x16') %>
				</a>

				<ul class="dropdown-menu right" style="margin: 2px -140px 0px;">
					<li><%= link_to "Editer", edit_email_path(email.id) %></li>
					<li><%= link_to "Supprimer" %></li>
				</li>
				</ul>
			</div>

		</center></td>
  </tr>
  <% end %>
  </tbody>
  </table>
  
</div>
<% end %>
