<%# encoding: utf-8 %>

<div class="navbar">
  <div id="navbar-inner" class="navbar-inner">
    <div id="left-bar-container">	
      <%= link_to image_tag("logo_crm_small.png"), url_for(:controller => 'home', :action => 'index' ) ,:class =>"brand" , :title => "Tableau de bord" %>
      <div id="nav-menu">
        <ul class="nav" style="font-size: 14px;">

          <!-- TASKS -->

          <% cssClass = (params[:controller] == 'tasks') ? 'active' : '' %>
          <li class="<%= "#{cssClass} "%>">
            <%= link_to (image_tag("icons/tache_blanc.png", :size => "16x16")+" Tâches").html_safe, url_for(:controller => 'tasks') %>
          </li>

          <!-- ACTORS -->

          <% cssClass = (params[:controller] == 'accounts' or params[:controller] == 'events' or params[:controller] == 'contacts') ? cssClass = 'active' : '' %>
          <li class="dropdown<%= if !cssClass.blank? then " #{cssClass}" end %>">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
              <%= image_tag("icons/3people_blanc2.png", :size => "20x16", :style => 'height: 16px; margin-top: 1px;') %> Acteurs
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
              <li><%= link_to "Comptes".html_safe, accounts_path %></li>
              <li><%= link_to "Contacts".html_safe, contacts_path %></li>
            </ul>
          </li>

          <!-- TRADES -->

          <% cssClass = (params[:controller] == 'quotations' or params[:controller] == 'opportunities') ? 'active' : '' %>
          <li class="dropdown<%= if !cssClass.blank? then " #{cssClass}" end %>">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
              <%= image_tag("icons/glyphicons_040_stats_white.png", :size => "20x16") %> Commerce
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
              <li><%= link_to "Opportunités".html_safe, opportunities_path %></li>
              <li><%= link_to "Devis".html_safe, quotations_path %></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
    <div id="right-bar-container">

      <!-- FORM SEARCH -->

      <div id="form-search-container">
        <%= form_tag(search_accounts_path, :method => "get", :class =>"form-search", :id =>"form-search") do %>
          <div class="input-append">
            <%= text_field_tag :account , nil , { :class =>"span3", :placeholder => " Rechercher un acteur...", :autocomplete=> "off", :type => 'text', :id => 'main-search-bar' } %>
            <button type="submit" class="btn">
              <i class="fa fa-search fa-fw"></i>
            </button>
          </div>
          <ul id="search-list" class="typeahead dropdown-menu"></ul>
        <% end %>
      </div>

      <% if user_signed_in? %>
        <div id="profile_settings_buttons">
        <%= render 'shared/right_icon_menu' %>
        </div>
      <% end %>
    </div>
  </div>
</div>
<script type="application/x-javascript">
  var dom_browse_offset = function(dom_object) {
    return dom_object.offsetParent ? dom_object.offsetLeft + dom_browse_offset(dom_object.offsetParent) : dom_object.offsetLeft;
  };

var dom_profile = document.getElementById('profile_settings_buttons');
var dom_search_form = document.getElementById('form-search-container');
var left = dom_browse_offset(dom_profile);
var right = window.innerWidth - left - 15;
$(dom_search_form).attr('style', 'right: ' + right + 'px;');

</script>

