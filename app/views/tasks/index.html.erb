<%= render 'filter', :locals => { :filter => @filter }%>
<%= render 'title', :locals => { :title => @title }%>

<div class="container-fluid">
  <table class="table table-bordered table-striped table-hover">
    <thead>
      <tr>
        <th><center>#</center></th>
        <th><center>Statut</center></th>
        <th><center>Priorité</center></th>
        <th><center>Compte</center></th>
        <th><center>Sujet</center></th>
        <th><center>Contact</center></th>
        <th><center>Échéance</center></th>
        <th><center>Collaborateur</center></th>
        <th><center>Éditer</center></th>        
      </tr>
    </thead>
    <tbody>
      <% @tasks.each do |task| %>
      
	  <% if task.priority == "Haut"%>
	  	  <tr class="error">
	       <% elsif task.priority == "Urgent"%>
	  	  <tr class="error" style="font-weight:bold;">
		  <% elsif task.priority == "Bas"%>
	  	  <tr class="info">
       <% end %>

	  <td><center><%= task.id %></center></td>
        <td><center>
          <% if task.statut == "A faire"%>
            <span class="badge badge-important">
          <% elsif task.statut == "En cours"%>
            <span class="badge badge-warning">
          <% elsif task.statut == "Terminé"%>
            <span class="badge badge-success">
          <% elsif task.statut == "Annulé"%>
            <span class="badge badge-inverse">
          <% else %>
            -
          <% end %>
          <%= task.statut %></span>
        </center></td>
		
		<% if !task.priority.blank? %>
			<% then %>
				<td><center><%= task.priority %></center></td>
			<% else %>
				<td><center>-</center></td>
		<% end %>
		
		<% if !task.account.nil? %>
			<% then %>
				<td><center><%= link_to task.account.company , account_events_url(task.account),{:title => "Afficher les évenements"} %></center></td>
			<% else %>
				<td><center>-</center></td>
		<% end %>
		<% if !task.title.blank? %>
			<% then %>
				<td><%= link_to truncate(task.title, :length => 75, :separator => ' '), edit_task_path(task),{:title => "Éditer la tâche"} %></td>
			<% else %>
				<td><center>-</center></td>
		<% end %>

		<% if !task.contact.nil? %>
			<% then %>
				<td><center><%= link_to task.contact.full_name, edit_contact_path(task.contact),{:title => "Éditer le contact"}  %></center></td>
			<% else %>
				<td><center>-</center></td>
		<% end %>		

		<% if !task.term.blank? %>
			<% then %>		
				<td><center><%= task.term.split('/').reverse!.join('/') %></center></td>
			<% else %>
				<td><center>-</center></td>
		<% end %>

		<% if !task.user.nil? %>
			<% then %>		
				<td><center><%= task.user.full_name %></center></td>
			<% else %>
				<td><center>-</center></td>
		<% end %>

		<td><center><%= link_to image_tag("glyphicons/glyphicons_151_edit.png"), edit_task_path(task) ,{:title => "Éditer la tâche", :class =>"btn"}  %></center></td>
 </tr>
      <% end %>
    </tbody>
  </table>
  
  <br />
  
  <%= paginate @tasks %> 

</div>
