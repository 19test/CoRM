<%= form_for(@task, :html => { :class => "well "}) do |f| %>
  <% if @task.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@task.errors.count, "error") %> prohibited this task from being saved:</h2>

      <ul>
      <% @task.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>


  <div class="field">
    
      <div class="span2"> Compte : </div>
      <!-- <%= f.collection_select :account_id, Account.order('company ASC').all, :id, :company, {:include_blank => true} %> -->
      <p><%= f.text_field :account, {:class => "typeahead-search-account not-links" , :id =>"task_account_id" , :type=> "search" } %><span class="label label-info" id="task_notice"  style="display: none; margin-left: 2em;"><i class="icon-warning-sign icon-white"></i> Un événement sera créé sur le compte correspondant</span></p>
      
    
  </div> 

  <div class="field" id="nameContacts">
    <%= render :partial => 'contacts' %>
  </div>
  
  <div class="field">
    <div class="span2"> Affectée à : </div> <%= f.collection_select :user_id, User.all, :id, :full_name %> <%= check_box_tag :mail, "yes"%> Envoyer un email à ce collaborateur
  </div>
  
    <div class="field">
    <div class="span2"> Sujet : </div> <%= f.text_field :title , { :required => 'required', :style=>'width: 30em;'} %>
  </div>
  
  <div class="field">
	  <div class="span2">Description : </div> <%= f.cktext_area :notes, :ckeditor => {:toolbar => "MyToolbar"} %>
  </div>
 <br />

 <div class="field">
    <div class="span2"> Statut : </div> <%= f.select :statut, Task::STATUTS %>
  </div>
  
   <div class="field">
    <div class="span2"> Priorité : </div> <%= f.select :priority, Task::PRIORITIES, :selected => @task.priority.nil? ? "Normal" : @task.priority %>
  </div>
  
  <div class="field">
    <div class="span2"> Echéance :  </div> <%= f.text_field :term %>
  </div>  
  

	<% if @task.attach.exists? %> 
		<div class="field"><div class="span2">Pièce jointe actuelle : </div><%= link_to image_tag('glyphicons/glyphicons_062_attach.png') + ' ' + @task.attach_file_name, @task.attach.url, :target => '_blank' %></div>
		<div class="field"><div class="span2">Modifier pièce jointe : </div><%= f.file_field :attach, :style=>'width: 20em;' %></div>
		<% else %>
		<div class="field"><div class="span2">Pièce jointe : </div><%= f.file_field :attach, :style=>'width: 20em;' %></div>
	<% end %>
 

  <br />

  <div class="field">
    <div class="span2"><%= check_box_tag :generate, "yes" %> Infos de l'événement</div>
  </div>
  <br />
  
  <div id="task_values" style="display: none;">
  <div class="row">
    <div class="span12">
      Type de l'évènement : <br /> <%= collection_select :event_type, :id ,EventType.order('label'),:id, :full_type, {:style =>"width: 100%"}%>
    </div>
  </div>
  
  <div class="row">
    <div class="span12">
      Notes de l'évènement : <br /> <%= text_area_tag :notes , nil,:display_with => :simple_format, :rows => "5", :style=>'width: 30em;'%>
    </div>
  </div>
  </div>
  <br />
  	
	<div class="field">
    <% if !@task.id.nil? %>
		<div class="span9"> Créée par : <%= @task.author.full_name %>, le </strong><%= @task.created_at.strftime("%d/%m/%y à %H:%M") %>. </div> <br />
		
		<% if !@task.modified_by.nil? %>
			<div class="span9"> Dernièrement modifiée par : <%= @task.editor.full_name %>, le <%= @task.updated_at.strftime("%d/%m/%y à %H:%M") %>. </div> <br />
		
		<% else %>
		<% end %>
	
	<% end %>
	</div>
	  
	<hr />
    
  <div class="row">
	  <%= if !@task.id.nil? then f.submit 'Modifier cette Tâche', :class =>"btn btn-primary" else f.submit 'Créer une Tâche', :class =>"btn btn-primary" end %>

      <%= if !@task.id.nil? then link_to image_tag("glyphicons/glyphicons_016_bin.png"), @task, :title => "Supprimer la tâche" , :confirm => 'Confirmer la suppression ?', :class =>"pull-right btn", :method => :delete end %>    
  </div>

<% end %>
